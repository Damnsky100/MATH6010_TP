# Import the librairies from f_elasticNetModel.R

```{r}
library(lubridate)
library(PerformanceAnalytics)
library(here)
library(xts)
library(zoo)
library(TTR)
library(stats)
library(caret)
library(glmnet)
library(Metrics)
library(quantmod)
library(R6)


source(here("Function", "f_clean_data.R"))
source(here("Function", "f_cluster.R"))
source(here("Function", "f_elasticNetModel.R"))


```


## Download the data 


```{r}
# Download Data
# List of tickers
df_clusters_yearly <- f_cluster(10)
tickers <- c("AMAT" , "COST", "DISH" , "GILD",  "GOOGL", "MSFT",  "QCOM", "QRTEA", "RYAAY", "VRTX")
priceData <- get_stock_data(tickers)

summary(priceData)


# Save the 'data' object to an RData file
save(priceData, file = here("Clean_Data", "stock_data.rda"))

# To load the data back into R at a later time
load(here("Clean_Data", "stock_data.rda"))


```

```{r}
#Trouver notre univers d'investissement

# Rouler la crÃ©ation de notre objet + manipulations
result <- init_instance(priceData, tickers)

# Retreive the best elastic net model for each tickers (Just switch GE for the another ticker)
result$resultsList$AMAT$model

#Retreive the coefficients of the models for each tickers (Just switch GE for the another ticker)
result$resultsList$AMAT$coefficients

#Retreive the MSE (Out of sample - Testing set) for every model (Just switch GE for the another ticker)
result$resultsList$AMAT$mse

# Retreive the price predicion in 10 days for the tickers 
dates <- result$featuresList[[result$tickers[1]]]$date 
testRange <- result$get_date_range("2017-12-31", "2023-01-01", 0, dates)
result$pricePrediction 
res <- as.data.frame(result$pricePrediction)
rownames(res) <- dates[dates %in% testRange$start:testRange$end]
colnames(res)<- tickers
res
#Retreive l'univers d'investissement
result$tickers 


```



## Save in a rda file for efficiency
```{r}

save(res, file = here("Clean_Data", "pricePrediction.rda"))

```



```{r}



```